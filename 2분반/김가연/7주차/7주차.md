# 7주차 Chapter 4-1 ~ 5-7

## 쿠키의 등장
: 쿠키가 도입되면서 웹 브라우저는 이전에 접속했던 사용자의 정보를 웹 서버로 전송할 수 있게 되었고, 웹 서버는 이 정보를 바탕으로 현재 접속한 사용자가 누구인지도 알 수 있게 됐다.

## 쿠키의 용도 세 가지
* 세션 관리(인증) : 서버에 저장해야 할 정보를 관리
* 개인화 : 사용자 선호, 테마 등의 설정
* 트래킹 : 사용자 행동을 기록하고 분석하는 용도

## 쿠키의 생성
```javascript
// 간단한 웹 서버 구현 후, 쿠키 생성
var http = require('http');
http.createServer(function(request, response) {
  //response.writeHead(200, {
  //  'set-cookie': ['yummy_cookie=choco', 'tasty_cookie=strawberry']
  //});
  response.end('Cookie!!')
}).listen(3000);
```

## 쿠키 읽기
: 생성한 쿠키를 웹 브라우저가 어떻게 알아낼 수 있는지 살펴보기

### 쿠키 모듈 설치
```
npm install -s cookie
```
### 쿠키 읽기 코드

```javascript
var http = require('http');
var cookie = require('cookie');
http.createServer(function(request, response) {
    console.log(request.headers.cookie);
    var cookies = {};
    if(request.headers.cookie !== undefined) {
        cookies = cookie.parse(request.headers.cookie);
    }
    console.log(cookies.yummy_cookie);
    response.writeHead(200, {
        'Set-Cookie':['yummy_cookie=choco', 'tasty_cookie=strawberry']
    });
    response.end('Cookie!!');
}).listen(3000);
```

## 쿠키 활용
* ID 저장, 로그인 상태 유지
* 일주일간 다시 보지 않기.
* 최근 검색한 상품들을 광고에서 추천
* 쇼핑몰 장바구니 기능

## 세션과 영구 쿠키
: 쿠키가 언제까지 살아있게 할 것인가?

* 세션 쿠키 : 웹 브라우저가 커져있는 동안에만 유효한 쿠키라서 브라우저를 종료했다가 다시 실행하면 사라져 있음.
* 영구 쿠키 : 영속적인 쿠키로서 웹 브라우저를 종료 했다가 다시 실행해도 쿠키가 살아있음.
  - 세션쿠키에 Max-Age나 Expires 같은 옵션을 설정하면 영구 쿠키가 됨.
    - Max-Age : 쿠키가 현재부터 얼마 동안 유효한 지 지정 (상대적)
    - Expires : 쿠키를 언제 해지할 지 지정 (절대적)

    ```javascript
    // 영속적인 쿠키 추가하기
    `Permanent=cookies; Max-Age=${60*60*24*30}`
    ```
## 쿠키 옵션
### Secure
: 웹 브라우저와 웹 서버가 HTTPS 프로토콜로 통신하는 경우에만 쿠키를 전송하는 옵션.<br>

* HTTP를 사용하면 쿠키값을 쉽게 가로채서 악의적으로 사용할 위험성이 있다.
 
### HttpOnly
: HTTP 프로토콜로 통신하는 경우에도 쿠키를 전송하지만 자바스크립트로는 쿠키값을 가져올 수 없게 하는 옵션

### Path
: 특정 디렉터리(경로)에서만 쿠키가 활성화되게 하고 싶을때 사용하는 옵션.

### Domain
: 어떤 서브도메인에서도 생성되는 쿠키를 만들 수 있는 옵션.

